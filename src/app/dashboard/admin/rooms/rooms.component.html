@if(viewAddRoomDialog){
<app-add-room (closeAddRoom)="onCloseAddRoom($event)" />
} @if(isLoading){
<div class="loading-overlay">
  <p-progress-spinner
    strokeWidth="3"
    fill="transparent"
    animationDuration=".5s"
    [style]="{ width: '50px', height: '50px' }"
  />
</div>
}

<p-toast />
<p-confirmdialog styleClass="confirm-dialog" />

<p-dialog
  header="Edit Room"
  [(visible)]="visible"
  [style]="{ width: '30rem' }"
  [modal]="true"
  [closable]="false"
  class="custom-dialog-content"
>
  <span class="dialog-subtitle"
    >Update room {{ roomToEdit.number }} details below.</span
  >

  <div class="dialog-form">
    <div class="form-group">
      <label for="roomType">Room Type</label>
      <!-- <input pInputText id="roomType" [(ngModel)]="roomToEdit.type" placeholder="e.g. Deluxe" autocomplete="off" /> -->
      <p-dropdown
        [options]="roomType"
        [(ngModel)]="roomToEdit.type"
        placeholder="Select Room Type"
        class="custom-input"
      />
    </div>

    <div class="form-group">
      <label for="price">Price</label>

      <p-inputNumber
        id="price"
        [(ngModel)]="roomToEdit.price"
        [min]="0"
        [mode]="'currency'"
        currency="INR"
        locale="en-IN"
        class="custom-input-number"
      >
      </p-inputNumber>
    </div>

    <div class="form-group">
      <label for="description">Description</label>

      <textarea
        pTextarea
        id="description"
        [(ngModel)]="roomToEdit.description"
        rows="3"
        placeholder="Enter room description"
        class="custom-textarea"
      >
      </textarea>
    </div>
  </div>

  <div class="dialog-actions">
    <button
      pButton
      type="button"
      label="Cancel"
      class="btn-secondary"
      (click)="visible = false"
    ></button>
    <button
      pButton
      type="button"
      label="Update"
      class="btn-primary"
      (click)="updateRoom()"
    ></button>
  </div>
</p-dialog>

<div class="room-management">
  <div class="header">
    <div>
      <h2>Room Management</h2>
      <p class="subtitle">Manage all hotel rooms and their availability</p>
    </div>
    <button
      pButton
      type="button"
      label="+ Add New Room"
      icon="pi pi-plus"
      class="add-room-btn"
      (click)="onClickAddRoom()"
    ></button>
  </div>

  <p-table
    [value]="paginatedRooms()"
    class="room-table"
    responsiveLayout="scroll"
    [sortMode]="'multiple'"
  >
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="number">
          Room Number <p-sortIcon field="number"></p-sortIcon>
        </th>
        <th pSortableColumn="type">
          Type <p-sortIcon field="type"></p-sortIcon>
        </th>
        <th pSortableColumn="price">
          Price <p-sortIcon field="price"></p-sortIcon>
        </th>
        <th pSortableColumn="is_available">
          Status <p-sortIcon field="is_available"></p-sortIcon>
        </th>
        <th>
          Description
        </th>
        <th>Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-room>
      <tr>
        <td>{{ room.number }}</td>
        <td>{{ room.type }}</td>
        <td>â‚¹{{ room.price }}/night</td>
        <td>
          <span
            [ngClass]="{
              'status-available': room.is_available === true,
              'status-occupied': room.is_available === false
            }"
          >
            {{ room.is_available ? "Available" : "Occupied" }}
          </span>
        </td>
        <td>{{ room.description }}</td>
        <td class="actions">
          <button
            class="icon-btn edit-btn"
            type="button"
            (click)="onSelectEditRoom(room)"
          >
            <i class="material-icons">edit</i>
          </button>
          <button
            class="icon-btn delete-btn"
            (click)="onSelectDeleteRoom($event, room.number)"
            type="button"
          >
            <i class="material-icons">delete</i>
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <p-paginator
    [rows]="rowsPerPage"
    [totalRecords]="rooms.length"
    (onPageChange)="onPageChange($event)"
    styleClass="custom-paginator"
  ></p-paginator>
</div>
